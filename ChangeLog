Darkstar ChangeLog


!! RELEASE: 0.1.3 (12/28/01) !!


12/28/01

 * The module loader now checks for duplicate config and format variables.

 * [tabkey.dsm] /loadmod, /reloadmod, and /unloadmod now have completion for
   all arguments, not just the first.

 * The darkstar status bar should now properly display nicks and channels
   containing \'s.

 * Forgot to escape some parentheses in the darkstar status bar.

 * Config variables were not being properly removed when modules were
   unloaded. Oops.

 * [window.dsm] Config variables renamed: AUTO_CREATE_MSG_WINDOW - > MSG_WINDOW
   and AUTO_CREATE_MSG_WINDOW_ARGS -> MSG_WINDOW_ARGS. The msg window will
   now also be created/killed when MSG_WINDOW is toggled.


!! RELEASE: 0.1.2 (12/25/01) !!


12/25/01

 * New core command: /loadedmodules

 * HEADS UP: Changes to the theme system. Each theme will now need to have
   its own directory (within one of the theme directories) containing
   <themename>.dst as well as individual files for each module. This solves
   the problem of modules not using theme settings when loaded after a theme
   has been chosen. I have also started using /assign rather than /fset to
   change format variables in themes, as it is far more efficient. Using /fset
   in your themes will still work, it just won't be as fast. See the two
   included themes for examples of the new theme format.

   Theme authors: The nature of these changes allow old themes to be easily
   converted to the new and more efficient format by following these easy
   steps:
	- Start a client running this version (or newer) of Darkstar.
	- Make sure all modules that you have theme settings for are currently
	  loaded.
	- /load ~/.darkstar/themes/<oldtheme>.dst
	- /save
	- mv ~/.darkstar/themes/custom ~/.darkstar/themes/<theme_name>

 * Fixed a bug in /unloadmod that was causing commands like "/unloadmod 1-3"
   and "/unloadmod 1 2 3" to not work.

12/24/01

 * [channel.dsm] New format variables: ACTION_CHANNEL, ACTION_CHANNEL_OTHER,
   SEND_ACTION_CHANNEL, and SEND_ACTION_CHANNEL_OTHER.

 * [misc.dsm] New format variables: ACTION_USER and SEND_ACTION_USER.

 * Regrettably I must break some some themes by changing the arguments passed
   to $fparse() for some of channel.dsm's format sets. The list of affected
   variables is as follows: CHANNEL_SIGNOFF, CHANNEL_SYNC, JOIN, and LEAVE.
   If your theme(s) use any of these variables you may need to adjust them
   slightly. I apologize for the inconvenience but this should make things
   much better in the long run.


!! RELEASE: 0.1.1 (12/23/01) !!


12/23/01

 * Rewrote large parts of the module loader (loader.dsc). Changes include:
	- Greatly improved error checking.
	- /loadmod and /unloadmod can now take multiple arguments.
	- Increased efficiency.
	- Down to 7449 bytes from 8962 bytes.

 * Added help pages for /less, /reload, /sv, and /uptime.

 * Forgot to unset NAMES_FOOTER in both themes.

 * Forgot to escape some ()'s in the darkstar status.

 * [names.dsm] Aliased /names to /scan to prevent people from accidentally
   executing the internal /names with no arguments.

 * [misc.dsm] /whowas will now display WHOIS_HEADER and WHOIS_FOOTER if present.

 * Moved /reload, /sv, and /uptime out of darkstar.irc and into commands.dsc.


!! RELEASE: 0.1.0 (12/22/01) !!


12/22/01

 * The core scripts have been documented!

 * The STRFTIME format variable has been removed as well as $getstrftime().
   I was using them to get around the problem of $cparse() and $strftime()
   using the same % codes. We now get around this by using "%%" to make a
   literal "%" anywhere $strftime() is used. Themes will need to be adjusted
   accordingly.

 * [autocycle.dsm] AUTO_CYCLE_OPLESS renamed to AUTO_CYCLE.

 * Renamed some internal functions to prevent them from showing up in
   command completion.

12/21/01

 * Format settings (/FSET) are now saved to $DS.USER_DIR/themes/custom.dst.
   This allows us to choose "custom" as our theme and simulate the
   pre-theme-support behavior (changes made with /fset will be remembered).

 * [window.dsm] The msg window (AUTO_CREATE_MSG_WINDOW) now defaults to OFF.

 * Various improvements and cleanups in save.dsc, themes.dsc, and status.dsc.

 * Made some internal changes to the way we keep track of config/format
   variables to avoid possible conflicts with the names of modules.

 * The epic4 theme is now the default.

 * The DEFAULT_THEME config variable has been renamed to THEME and will now
   change the theme if set to a valid theme name. See below.

 * The config script (config.dsc) will now hook any changes to config (not
   format) variables to the "hook" /on hook. The arguments it receives are
   as follows: CONFIG <variable name> <new value>

   This is mostly useful to module writers as they can now have code executed
   when a specific config variable is modified. If a variable has been
   removed (/dset -var) then no <new value> argument will be present.

12/20/01

 * Various cleanups in loader.dsc and save.dsc.

 * Save no longer saves any format settings. This is most likely a temporary
   change.

12/17/01

 * Apparently Linux systems don't understand $strftime(%+) so all occurrences
   of "%+" have been replaced with "%a %Ef %T %Z %Y".

 * Both themes now change BANNER to "***".

12/12/01

 * Fixed a bug in channel.dsm related to auto-response. Publics containing
   AUTO_RESPONSE_STR would not be displayed at all when AUTO_RESPONSE was OFF.

12/9/01

 * darkstar.irc will now remove the name of window #1 as well as set the level
   to "none". As such, this was removed from sample.dsrc.


!! RELEASE: 0.0.13 (12/3/01) !!


12/3/01

 * Improved support for channel completion in the tabkey module. If the first
   character of the last word on the input line is "#" the channel routine will
   be used. I add this at the last minute only because it is a very simple
   change, and a big improvement. I don't expect anything to break as a result.

12/2/01

 * The arguments passed to CTCP_REPLY have changed as of EPIC4-1.1 so themes
   will need to be adjusted accordingly.

 * HEADS UP! Modifications were made to the cleanup queues of several modules
   to take advantage of a fix made to /queue in EPIC4-1.1.2. As a result,
   the user will now be warned if their client is older than 12/3/01. The fix
   made to /queue involves the elimination of the initial evaluation made when
   the queue is first entered. What this means to module writers is they won't
   have to use so many escapes when removing certain /on hooks.

 * Darkstar should now warn the user more properly if their client does not
   meet the criteria for this script. In past versions the warning would be
   scrolled immediately off the screen by the module loader.

11/25/01

 * Small fix to /purge. (whitefang)

 * The included statbars were not using REVERSE_STATUS_LINE. They do now, and
   should work with EPIC4-1.1.

10/22/01

 * Fixed some small bugs that were causing the status/ and themes/ directories
   in the user directory to not work. (discovered by whitefang)

 * The "darkstar" statbar now resets the background color (via ^C-1) rather
   than specifically setting it to black.

10/21/01

 * [away.dsm] Auto-away and Auto-unset-away now both operate globally. Meaning
   they will set/unset away on all servers you are connected to. (whitefang)

 * [tabkey.dsm] Rewrite of tabkey.msg_routine() to be server-aware. This means
   you will now have separate nick histories for each server you are connected
   to. (requested by whitefang)

10/19/01

 * [functions.dsc] Added the $isloaded() function for determining whether
   a specific module is loaded or not. The $padright() function was also
   removed as it is identical to the builtin $pad() function, oops.


!! RELEASE: 0.0.12 (10/18/01) !!


10/18/01

 * Added $fparse2() to config.dsc. Works exactly the same as $fparse() except
   it does not pass its arguments through $cparse(). For the moment this is
   only being used by nickcomp.dsm. As a result, I am no longer replacing
   "^C-1" with "^C".

10/17/01

 * [keepnick.dsm] Fixed a bug discovered by whitefang and hop. Bad things
   can happen if you remove a /notify entry from within the notify_signoff
   hook. Instead we use /defer to execute it at a safer point in time.

 * [nickcomp.dsm] Now using $sar() instead of $tr() to strip "-1" out of
   text being sent to the channel. We also now look for "^C-1" and replace
   it with "^C" instead of just stripping all occurrences of "-1". Doing
   so is bad for obvious reasons.

 * [channel.dsm] Added the join/leave aliases from 2.8script. These may be
   removed later depending on upcoming changes to the internal /join command.

 * [away.dsm] Removed the "MsgLog Started/Stopped" timestamps as well as the
   "12:00" timestamp. This is because we now timestamp each individual message
   with both the date and time. The purpose for this change is to better
   support the use of multiple servers within a single EPIC process.

 * [away.dsm] Removed the /away and /back aliases.

 * [tabkey.dsm] Added support for file completion with /less.

 * [away.dsm] /readlog now uses /less provided by commands.dsc. Both /readlog
   and /remlog can now take a filename as an argument. You will also no
   longer be prompted to read your msglog when unsetting away.

 * New core script: commands.dsc. This file is just like functions.dsc except
   that it will contain commands not functions. I added a /less written by
   hop and I moved /purge from functions.dsc to commands.dsc.

10/16/01

 * [channel.dsm] Removed the join alias.

 * [nickcomp.dsm] Now strips off trailing "-1" that $cparse() adds. This is
   mostly because mIRC doesn't understand ^C-1 so users actually see the
   "-1" at the end of your text.


!! RELEASE: 0.0.11 (10/15/01) !!


10/15/01

 * Some changes to how we keep track of modules, statbars, and themes. The
   name and filenames are now kept in separate arrays. This fixes a potential
   problem with having similarly named modules/statbars/themes/etc. 

 * I am now passing more arguments to the various WHOIS_* format sets
   in misc.dsm. This allows for more customization of whois output via /fset.
   This will affect all themes that use these format sets.

 * Improved error checking in the theme loader. You should get a bit more
   information as to why loading a theme failed. I will also be adding this
   to the module loader at some point.

 * Removed the "blue" status bar. This, and others, will be distributed
   separately from now on.

 * Added a def/ directory in DS.USER. I accidentally left this out when I
   added user directory support. This is required in order for user directory
   modules to create /dset and /fset variables. Supporting this involved
   some changes in the way the module loader keeps track of modules.

10/14/01

 * [status.dsc] /status now supports the "-q" option which causes it to
   be quiet about the statbar change.

 * Major changes to theme support. Theme files are now just /load'd rather
   than parsed for keywords. This means that the format of the theme files has
   changed. See one of the included themes for details. The reason for all of
   this is so that themes can remove format variables, thus causing their
   hooks not to echo anything to the screen. This also involved changing
   a bunch of code in various modules.

 * [misc.dsm] New format variable SEND_CTCP.

 * [misc.dsm] New config variables SHOW_AWAY_ONCE and SHOW_AWAY_ONCE_TIMEOUT.
   This will stop you from seeing multiple 301 numerics (whois away).

 * I removed %D (DCC status) from the "darkstar" status bar as it caused rapid
   screen redraws. These redraws were enough to saturate the bandwidth on
   dialup connections.

10/12/01

 * Added /purge to functions.dsc (requested by whitefang).

 * [nickcomp.dsm] The new format variable NICK_COMPLETION now determines the
   formatting of nick completion output. The config variable
   NICK_COMPLETION_CHAR now determines the trigger character for nick completion.

 * Fixed a bug in the module loader that was causing /DSET and /FSET variables
   to not be removed upon unloading of their modules.

 * [away.dsm] Some pretty significant changes here. /AWAY and /BACK are now
   simple aliases to //AWAY that just reverse the default behavior from being
   local to global (The "-a" option is passed to //AWAY unless the "-l" option
   is passed to the aliases). Everything else is now hooked by the 305 and 306
   numerics. This also means that the DEFAULT_AWAY_REASON and
   DEFAULT_BACK_REASON config variables have been removed. You must now specify
   a reason manually if you wish to set yourself away. (requested by whitefang)

 * Theme support now actually works ;)

 * Now supports what I call a "user directory." This is just a place where
   you can store your own modules, statbars, and themes, as well as saved
   settings. This involved changes to most of the core scripts.

 * Darkstar will now automatically create the "user directory"
   (env. var. DARKSTAR_USER or ~/.darkstar by default) if it is not found.
   The following subdirectories are also created:
	modules/        save/           status/         themes/

10/11/01

 * /LOADMOD and /UNLOADMOD can now take either module names or an integer as
   an argument. (requested by whitefang)

10/8/01

 * [tabkey.dsm] New config variable: TABKEY_NICKCOMP_SUFFIX. This will be
   appended to the end of the nick, before the space, when an exact match is
   found and the nick is the first word on the input line. (Requested by
   whitefang and stshatter)

 * New format for the ChangeLog, as you can see. :-)


--

[0.0.10]

 - [loader.dsc] The module list will no longer be displayed if AUTO_LOAD_PROMPT
   is false. (whitefang)
 - [loader.dsc] Went through a bit of a rewrite.
 - New config variable: DEFAULT_THEME. This is now how you should be setting
   your default theme. You can remove the "status" line from your rcfiles.
 - Theme support! Theme files will be kept in $DS.HOME/themes/ default and must
   have an extension of ".dst". Have a look at the darkstar theme for an
   example of creating a theme.
 - New status bar called "blue". Created by stshatter.
 - Moved the defaults/ directory to def/.
 - Now understands both dset/fset as well as config/format as keywords in the
   *.def files.
 - [channel.dsm] New format variable CHANNEL_TS for displaying channel
   timestamps.
 - Both the "darkstar" and "epic4" status bars now change window double for
   ALL open windows instead of just the current one.
 - [tabkey.dsm] Now checks for $CMDCHARS instead of "/" (yes this was stupid).
 - [tabkey.dsm] Now lists each variable on a separate line when displaying
   matches in the set routine.
 - [misc.dsm] New fsets: WHOIS_HEADER and WHOIS_FOOTER
 - Fixed a bunch of bugs in the "epic4" statbar (Thanks to Jeremy Nelson).
 - [status.dsc] /status now displays a list of available statbars and prompts
   the user to choose one if no arguments are given.
 - Global variable renaming: DS.VERSION -> DS.INTERNAL_VERSION,
   DS.VER -> DS.VERSION. This wont affect end users.
 - [away.dsm] Finally stopped using $common() when checking
   PUBLIC_AWAY_CHANNELS. This allows for channel names containing "/", a
   valid character in channel names.
 - New environment variable: DARKSTAR_SAVEDIR. The SAVE_DIRECTORY config
   variable has been removed entirely. Please use the previously mentioned
   environment variable to change the default save directory.
 - Changes to the format of the defaults files. Boolean config variables now
   need to be specified with the "bool" keyword. Everything else is taken as
   a literal config variable (opposite of old behaviour).
 - Renamed "scan.dsm" to "names.dsm". /scano, /scann, and /scanv were
   also added. 
 - [core] Status bar directory moved from statbars/ to status/. Complete
   rewrite of the /status command (/statbar). Status files can now have any
   name they want instead of status.1, status.2, etc. The DEFAULT_STATUS
   config variable was also removed.
 - [core] Changes to allow the use of ON/OFF and 1/0 with /dset. The defaults
   files can now take an optional argument to the "config" command: lit
   This tells the script that that variable has a literal value and should not
   be converted to/from on/off/1/0. Two new functions: $convert.num() and
   $convert.onoff().
 - [tabkey.dsm] Support for /save module completion added.
 - [save.dsc] Now allows you to specify a save directory as well as a list of
   modules. Usage: /save [-d <dir>] [*|module1] [module2] [...]
   If no modules are specific, settings for all modules, plus the core, are
   saved. [module] can be any currently loaded module or "core" to save the
   core script settings.


[0.0.9]

 - [loader.dsc] Variables and aliases in structures named after the module
   are now automatically removed when a module is unloaded. They no longer
   need to be removed by the module itself in its cleanup queue. (This is
   any alias or variable preceded by "modulename.")
 - [tabkey.dsm] File completion can now handle the use of ~ and will now
   display all matches if more than one is found.
 - [tabkey.dsm] Now supports command completion.
 - [away.dsm] Only replies to messages now if SEND_AWAY_NOTICE is true.
 - [oper.dsm] Added /operwall.
 - [away.dsm] Now uses the internal variable $A to determine if away or not.
   This fixes a bug that caused the script to think we're not away when the
   server says we are.
 - New dset variable: AUTO_LOAD_PROMPT - If true, you will be asked on startup
   which modules you would like to load (old behaviour). If false, the modules
   listed in AUTO_LOAD_MODULES will be loaded without prompting the user.
   (Requested by tokage)
 - Slight change to the format of the defaults files.
 - Fixed a bug in auto-response where public_other's would display the nick
   twice. (Discovered by myke)
 - Some speed improvements and general cleanup. Removed a bunch of $common()'s
   which are quite expensive. (Thanks to Jeremy Nelson for pointing these out)


[0.0.8]

 - [config.dsc/functions.dsc] Moved $fparse() and $setcat() from functions.dsc
   to config.dsc.
 - [channel.dsm] New fset: TOPIC_CHANGE. Added two new aliases: /oldtopic
   (displays old topic) and /setoldtopic (sets topic to old topic). (Requested
   by BlackJac).
 - Slight change to the license. See the 'COPYRIGHT' file for details.
 - [channel.dsm] Now supports showing op/voice in publics.
   New fset: SHOW_OPVOICE_IN_PUBLICS.
 - [darkstar.irc] Fixed a bug where cleanup queue's weren't being removed
   during a /reload.
 - Broke up fsets.dsm into channel.dsm (channel related stuff) and misc.dsm.
   autoresponse.dsm was also merged into channel.dsm
 - [functions.dsc] Removed $getsamechars() as it is no longer needed. The
   built-in function $prefix() performs the same task.
 - Reverted every occurrence of "$(K)$(K)" back to "//" since EPIC always
   treats "//" as special regardless of $CMDCHARS.
 - [misc.dsm] Added /dns and /nslookup. (Requested by myke)
 - [darkstar.irc] Now allows the use of the following environment variables:
   DARKSTAR_HOME, DARKSTAR_RC, DARKSTAR_SAVE_DIR. Their purpose should be
   pretty obvious. This replaces the "Config Section" in darkstar.irc and
   should no longer be edited. The new default directory is ~/darkstar.
   Also made the $get_core_settings() function run a little faster.
 - [keepnick.dsm] Getnick will now disable itself if it discovers that you
   are already using the nick it wants. Also fixed a big that would cause
   getnick to be stuck on.
 - [save.dsc] Was not saving core script settings *oops*. It does now.
 - Moved core/fsets.dsc to modules/fsets.dsm. The banlist hooks and da5id's
   who hook were also moved from fsets.dsm to misc.dsm.
 - [away.dsm] Now keeps track of how many new msgs you have.
 - [tabkey.dsm] Lots of changes and new completion triggers. Added /cleartab
   to clear the tabkey nick history. (requested by tokage).
 - [scan.dsm] Fixed a small bug that would cause /scan not to work on channels
   that had "/" in them. Fixed by replacing $common() with $match().
   (discovered by kasper)


[0.0.7]

 - [away.dsm] Forgot to convert some global variables to the new style. Also
   fixed a bug where /readlog would attempt to open your logfile regardless
   of whether it existed or not. (discovered by myke)
 - [functions.dsc] Added function $getsamechars() for returning all the
   characters that are the same between two words leading up to the point
   where they first differ.
 - [tabkey.dsm] Now includes support for nick completion and file completion.
   The current triggers are /m, /msg, /dcc, and /load. Everything else triggers
   the nick completion. Eventually I would like to be able to add/remove
   tabkey triggers on the fly.
 - All core script files have been renamed from *.ds to *.dsc
 - [loader.dsc] Added a /reloadmod command. Just performs /unloadmod and
   /loadmod for you.
 - [away.dsm] Now prompts you to read your msglog when setting yourself back.
 - [functions.dsc] Fixed a bug in $getsamechars() which was causing it to
   return matching characters after failing on previous characters.
 - Help system added! The code for /dhelp is located in core/help.dsc and was
   provided by WhiteDrgn (thanks!). It uses EPIC's built-in help system so
   not much code had to be added. No actual help files just yet.. but expect
   some in the next release.
 - [save.dsc] Fixed a bug that was causing some module settings not to be
   saved.
 - Moved $getov() out of functions.dsc and into scan.dsm as $scan.getov()


[0.0.6]

 - Added global variable $DS.RCFILE (default: ~/.epic4/.dsrc) and the file
   sample.dsrc
 - Added /reload to darkstar.irc
 - [misc.dsm] /join no longer requires a leading # for channels names. If
   a '#' or '&' is preceding the channel name, nothing will be done and it
   will be passed to //join. If neither '#' nor '&' are found the script will
   automatically add a '#' to the beginning of the channel name and pass it on
   to //join. (requested by myke)
 - [misc.dsm] /lk now asks you if you're sure you want to kick all non-ops.
 - [misc.dsm] Added /invite and /i.
 - [autocycle.dsm] Cleaned things up a bit.
 - Fixed a small bug in statbar.2 where channels without modes would have an
   extra ']' on the statbar.
 - Moved all the /scan stuff out of core/fset.ds and into a module (scan.dsm)
 - MAJOR CHANGES TO CORE: All /dset's (/config) and /fset's are now completely
   modular, yet do not appear as such to the user. Specifying a module # when
   using /config is no longer necessary and saved settings are now safe from
   being overwritten. Many changes to the rest of the core script (and even
   modules) had to made in order to implement this. /dset and /fset are now
   located in 'core/config.ds' and the on hooks for /fset have been moved to
   'core/fsets.ds'. Changes to the format of the defaults files also had to be
   made. Please see the 'README' file for details.
 - Replaced all occurrences of "//" with "$(K)$(K)" to allow users to change
   $CMDCHARS without breaking anything.


[0.0.5]

 - Fixed small bug in autocycle.dsm (found by RoboHak)
 - Fixed numerous bugs in /loadmod and /unloadmod (original problem discovered
   by defiler)
 - Syntax changes to /deop, /devoice, and /op. When specifying multiple nicks
   white space must now be used to separate the nicks rather than commas.
 - The "Insert" and "Delete" keys now scroll the msg window up/down. Thanks
   to adm for this. (The F12 key now clears the msg window)
 - Added /tempban to modules/misc.dsm
 - Shaved about 1600 bytes off core/loader.ds getting rid of some of the
   duplicate code for /loadmod, /unloadmod, and the auto-loader.


[0.0.4]

 - More speed improvements
 - Added /untopic to misc.dsm
 - Fixed a bug in statbar.ds where the statbar wouldn't completely update
   after being changed.
 - Many improvements to the module loader (core/loader.ds). /loadmod and
   /unloadmod now behave like /tban if given no arguments.
 - Changes to core/save.ds. /save now takes arguments for saving specific
   settings (-a, -c, -f, -m).
 - Lots of small changes not worth mentioning.
 - New /fsets: CHANNEL_NICK, CTCP, CTCP_REPLY, MODE, and UMODE.
 - Fixed a bug found in both /config and /fset where specifying an exact
   variable would result in the variable not being found.


[0.0.3]

 - Removed $isnum() and $ischan() from functions.ds. Use $isnumber() and
   $ischannel() now.
 - Made some speed improvements to /scan
 - Fixed a bug in /config where you couldn't see/change options for the
   last module. (found by Tilt)
 - Major re-write of both /fset and /config. Also removed $add_config_var()
   and $add_fset() as they are no longer needed.
 - Wrote a /save (core/save.ds).
 - New function: $setcat()  Performs the old duties of $_configcat() and
   $_fsetcat().
 - Moved functions $getov(), $getstrftime(), and $fparse() to
   core/functions.ds
 - Now using /queue to allow modules to specify exactly what needs to be
   cleaned up during unloading. You can now use /unloadmod *yay*


[0.0.2]

 - Added a config manager (core/config.ds)
 - /fset is now part of the core script and is located in the core/ directory.
   Several bugs in /fset were also fixed.
 - All modules and core scripts updated to use new /config.
 - Added a defaults/ directory and $DS.DEFAULTS_DIR for loading default
   settings. Module settings (/config) are loaded automatically by
   $load_module() but default formats must be loaded by the module itself.
 - All module filename extensions must now be .dsm
 - Added core/save.ds for saving /config and /fset settings. (/save)
 - Added /key and /unkey to misc.dsm
 - /cycle now supports the existence of channel keys.
 - Moved the status bar stuff into the core of the script (core/statbar.ds)
   Status bars are now stored in $DS.STATBAR_DIR (statbars/)
 - Many improvements to the loader.


[0.0.1]

 - Initial beta or whatever you wanna call it.


#EOF.